# 【Godot】場面切り替えサンプル

## バージョン情報

- Godot 4.2.2

## 機能

- 場面切り替えを統括するシーン
  - 自動読み込みに設定
  - 画面を隠すシーンを受け取って、管理
- 画面を隠すシーン
  - 一瞬で隠すアニメ
  - 指定の秒数で隠す
  - 隠し終えたら、シグナルを発行
  - 指定の秒数で覆いを外すアニメ
  - 多いが外れたら、シグナルを発行
- 読み込むシーンのデータ
  - あればそのまま利用するUIシーンと、読み直すステージシーンを想定
  - 読み込むシーンのデータは、リソースで用意
- 解放するシーンは自動判定

## デモ内容

- 起動は、タイトル代わりのシーンをメインシーンとして起動。起動の流れは別で実装
- ボタンでゲーム開始
- UIは読み込みっぱなしにする
- ステージ
  - ボタンでキャラを消す
  - リトライボタンで読み直す
  - タイトルボタンでタイトルへ戻る

## 必要なもの

- シーンチェンジャースクリプト
  - 自動読み込み
  - シーン切り替えの処理に関する機能を提供
- タイトル
- UI
  - ゲーム中のボタンを提供
- ステージ
  - クリックすると消えるボタンを配置
- フェードシーン
  - アニメーションで画面を隠す
  - 画面切り替え用の仮想関数を定義したベースクラスを持つ

## シーン切り替え処理の流れ

- SceneChanger.cover_and_change_scene(カバーシーンのインスタンス, 速度, シーンデータ)
  - 指定のカバーで画面を隠して、シーンの読み込みを開始
  - シーンを生成しながら、ready完了のシグナルに登録
  - すべての読み込みが完了したら、呼び出すシグナルに、次のシーンの初期化処理を登録させる
  - 読み込みが完了したら、処理をemit
- 次のシーンのreadyで、初期化処理を登録
- 次のシーンで、SceneChangerのuncover(倍率)でスクリーンを解除。コルーチン
